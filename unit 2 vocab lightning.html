<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Unit 2 — Vocab Lightning</title>
<style>
  body{font-family:Arial, sans-serif; background:#0b1220; color:#e6edf3; margin:0; padding:20px;}
  .wrap{max-width:900px; margin:auto;}
  h1{text-align:center;}
  .card{background:#101a2c; border-radius:12px; padding:16px; margin:20px 0;}
  .qtext{font-size:20px; font-weight:bold; margin-bottom:12px;}
  .choices{display:grid; grid-template-columns:repeat(2,1fr); gap:12px;}
  .tile{background:#0f2034; padding:16px; border-radius:10px; border:1px solid rgba(255,255,255,.2); cursor:pointer;}
  .tile.correct{background:#0e2b22; border-color:#1f8a67;}
  .tile.wrong{background:#3a0f16; border-color:#ff6b6b;}
  .pill{display:inline-block; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.3); background:#13233d; font-size:12px;}
  .hud{display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;}
  .hidden{display:none;}
</style>
</head>
<body>
<div class="wrap">
  <h1>Unit 2 — Vocab Lightning</h1>

  <!-- START -->
  <section id="start" class="card">
    <div class="hud">
      <label>Mode:
        <select id="mode">
          <option value="t2d">Term → Definition</option>
          <option value="d2t">Definition → Term</option>
        </select>
      </label>
      <button id="begin">Start Round</button>
    </div>
  </section>

  <!-- QUIZ -->
  <section id="quiz" class="card hidden">
    <div class="hud">
      <span class="pill" id="progress">Q 1/N</span>
      <span class="pill" id="timer">00:00</span>
      <span class="pill" id="best">Best: —</span>
    </div>
    <div class="qtext" id="prompt"></div>
    <div id="choices" class="choices"></div>
  </section>

  <!-- RESULT -->
  <section id="result" class="card hidden">
    <h2>Round Complete</h2>
    <div class="hud">
      <span class="pill" id="scoreline"></span>
      <span class="pill" id="timeline"></span>
      <span class="pill" id="bestline"></span>
    </div>
    <div id="review"></div>
    <div class="hud">
      <button id="retry">New Round</button>
      <button id="retryMissed">Retry Missed Only</button>
      <button id="restart">Back to Start</button>
    </div>
  </section>
</div>

<script>
// ------- Helpers -------
function shuffle(a){const r=[...a];for(let i=r.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[r[i],r[j]]=[r[j],r[i]];}return r;}
function fmtTime(s){const m=Math.floor(s/60).toString().padStart(2,'0');const ss=(s%60).toString().padStart(2,'0');return `${m}:${ss}`;}
function setBest(k,sec){const prev=Number(localStorage.getItem(k)||Infinity);if(sec<prev)localStorage.setItem(k,String(sec));}
function getBest(k){const v=localStorage.getItem(k);return v?fmtTime(Number(v)):'—';}

// ------- Sample vocab bank -------
const BANK = [
  {term:"Public opinion",def:"Aggregate of individual attitudes about government and politics.",chapter:6},
  {term:"Political socialization",def:"Process by which people acquire political beliefs and values.",chapter:6},
  {term:"Party identification",def:"Psychological attachment to a political party.",chapter:6},
  {term:"Suffrage",def:"Right to vote.",chapter:7}
  // … include all your vocab here …
];

let state={list:[],idx:0,mode:'t2d',misses:[],timer:null,seconds:0,missedOnly:false};
function bestKey(){return `best_vocab_${state.mode}`;}
function startTimer(){if(state.timer)clearInterval(state.timer);state.timer=setInterval(()=>{state.seconds++;document.getElementById('timer').textContent=fmtTime(state.seconds);},1000);}
function stopTimer(){if(state.timer){clearInterval(state.timer);state.timer=null;}}

function startRound(){
  state.mode=document.getElementById('mode').value;
  state.list=shuffle([...BANK]);
  state.idx=0;state.misses=[];state.seconds=0;state.missedOnly=false;startTimer();
  document.getElementById('start').classList.add('hidden');
  document.getElementById('result').classList.add('hidden');
  document.getElementById('quiz').classList.remove('hidden');
  document.getElementById('best').textContent='Best: '+getBest(bestKey());
  renderQ();
}

function renderQ(){
  const q=state.list[state.idx];
  document.getElementById('progress').textContent=`Q ${state.idx+1}/${state.list.length}`;
  document.getElementById('prompt').textContent=(state.mode==='t2d'?q.term:q.def);
  const correct=(state.mode==='t2d'?q.def:q.term);
  const wrongs=shuffle(BANK.filter(x=>x!==q)).slice(0,3).map(x=>state.mode==='t2d'?x.def:x.term);
  const choices=shuffle([{text:correct,correct:true},...wrongs.map(w=>({text:w,correct:false}))]);
  const box=document.getElementById('choices');box.innerHTML='';
  choices.forEach(c=>{
    const b=document.createElement('button');b.className='tile';b.innerHTML=c.text;
    b.onclick=()=>pick(c.correct,q,b);
    box.appendChild(b);
  });
}

function pick(ok,q,node){
  node.classList.add(ok?'correct':'wrong');
  if(!ok)state.misses.push(q);
  setTimeout(()=>{if(state.idx<state.list.length-1){state.idx++;renderQ();}else finish();},500);
}

function finish(){
  stopTimer();
  const total=state.list.length,missed=state.misses.length,correct=total-missed;
  if(!state.missedOnly)setBest(bestKey(),state.seconds);
  document.getElementById('quiz').classList.add('hidden');
  document.getElementById('result').classList.remove('hidden');
  document.getElementById('scoreline').textContent=`Score: ${correct}/${total}`;
  document.getElementById('timeline').textContent=`Time: ${fmtTime(state.seconds)}`;
  document.getElementById('bestline').textContent=`Best: ${getBest(bestKey())}`;
  const rev=document.getElementById('review');rev.innerHTML='';
  if(missed===0){rev.innerHTML='<p class="muted">Perfect! No missed items.</p>';}
  else{state.misses.forEach((m,i)=>{rev.innerHTML+=`<div>Missed ${i+1} (Ch.${m.chapter}) — Correct: ${(state.mode==='t2d'?m.def:m.term)}</div>`;});}
}

function startRoundMissed(){
  if(state.misses.length===0){alert("No missed items to retry.");return;}
  state.list=shuffle([...state.misses]);state.idx=0;state.seconds=0;state.missedOnly=true;startTimer();
  document.getElementById('result').classList.add('hidden');
  document.getElementById('quiz').classList.remove('hidden');
  renderQ();
}

document.getElementById('begin').onclick=startRound;
document.getElementById('retry').onclick=startRound;
document.getElementById('retryMissed').onclick=startRoundMissed;
document.getElementById('restart').onclick=()=>{document.getElementById('result').classList.add('hidden');document.getElementById('start').classList.remove('hidden');};
</script>
</body>
</html>
